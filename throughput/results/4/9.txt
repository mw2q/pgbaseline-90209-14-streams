BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%cornsilk%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 258091547.518392
 ALGERIA                   |   1997 | 449567689.459403
 ALGERIA                   |   1996 | 456841528.556737
 ALGERIA                   |   1995 | 453573856.655647
 ALGERIA                   |   1994 | 453803746.172795
 ALGERIA                   |   1993 | 452188854.339545
 ALGERIA                   |   1992 | 455411822.940759
 ARGENTINA                 |   1998 | 276453354.780855
 ARGENTINA                 |   1997 | 465600440.438606
 ARGENTINA                 |   1996 | 465808177.228673
 ARGENTINA                 |   1995 | 465644456.444988
 ARGENTINA                 |   1994 | 468563089.855094
 ARGENTINA                 |   1993 | 476337727.669303
 ARGENTINA                 |   1992 | 463488304.799632
 BRAZIL                    |   1998 | 273720291.813615
 BRAZIL                    |   1997 | 470666798.884962
 BRAZIL                    |   1996 |  472331263.54453
 BRAZIL                    |   1995 | 472941195.511362
 BRAZIL                    |   1994 | 474400694.461831
 BRAZIL                    |   1993 | 469536545.321438
 BRAZIL                    |   1992 | 474192987.545792
 CANADA                    |   1998 |  280832898.79985
 CANADA                    |   1997 | 478657940.175342
 CANADA                    |   1996 | 478544752.952349
 CANADA                    |   1995 | 477469968.417387
 CANADA                    |   1994 | 469972900.752184
 CANADA                    |   1993 | 473654410.000186
 CANADA                    |   1992 |  481251110.31471
 CHINA                     |   1998 | 276516397.434261
 CHINA                     |   1997 | 466362348.331042
 CHINA                     |   1996 | 468311414.408729
 CHINA                     |   1995 | 463629956.615542
 CHINA                     |   1994 | 466900881.165777
 CHINA                     |   1993 | 472062735.089791
 CHINA                     |   1992 | 470532643.180862
 EGYPT                     |   1998 | 273041536.091828
 EGYPT                     |   1997 | 458985983.678062
 EGYPT                     |   1996 | 465369994.388708
 EGYPT                     |   1995 | 464394915.805909
 EGYPT                     |   1994 | 452681001.429789
 EGYPT                     |   1993 | 459610393.290173
 EGYPT                     |   1992 | 467634521.190942
 ETHIOPIA                  |   1998 | 273163018.804514
 ETHIOPIA                  |   1997 |  452338369.44776
 ETHIOPIA                  |   1996 | 456326497.660592
 ETHIOPIA                  |   1995 | 449271147.343774
 ETHIOPIA                  |   1994 | 466214227.375385
 ETHIOPIA                  |   1993 |  456991489.49895
 ETHIOPIA                  |   1992 | 459756475.277519
 FRANCE                    |   1998 |  269130236.59596
 FRANCE                    |   1997 | 462161768.989096
 FRANCE                    |   1996 | 464607239.981885
 FRANCE                    |   1995 | 472622367.063033
 FRANCE                    |   1994 | 461489770.682828
 FRANCE                    |   1993 | 469319985.036789
 FRANCE                    |   1992 | 467296402.710457
 GERMANY                   |   1998 | 280522762.520266
 GERMANY                   |   1997 | 480637085.253174
 GERMANY                   |   1996 | 479452990.647737
 GERMANY                   |   1995 | 480811318.683127
 GERMANY                   |   1994 |  474698727.27921
 GERMANY                   |   1993 | 477243467.118477
 GERMANY                   |   1992 | 484148376.337755
 INDIA                     |   1998 | 272156843.992428
 INDIA                     |   1997 | 475578389.923033
 INDIA                     |   1996 | 473040936.031656
 INDIA                     |   1995 | 471583288.753493
 INDIA                     |   1994 | 476514289.031917
 INDIA                     |   1993 | 470058309.663255
 INDIA                     |   1992 |   473100306.7207
 INDONESIA                 |   1998 | 277571999.784363
 INDONESIA                 |   1997 |  467794454.52398
 INDONESIA                 |   1996 | 470214237.220003
 INDONESIA                 |   1995 | 469080814.288263
 INDONESIA                 |   1994 | 468898615.940009
 INDONESIA                 |   1993 | 459427957.026614
 INDONESIA                 |   1992 | 469730650.881915
 IRAN                      |   1998 | 267064838.466782
 IRAN                      |   1997 | 472579732.979368
 IRAN                      |   1996 | 454836701.166515
 IRAN                      |   1995 | 460075557.594769
 IRAN                      |   1994 | 460061527.077409
 IRAN                      |   1993 | 454427749.012329
 IRAN                      |   1992 | 454056488.925818
 IRAQ                      |   1998 | 278558092.932555
 IRAQ                      |   1997 | 475468959.238401
 IRAQ                      |   1996 | 472029276.153892
 IRAQ                      |   1995 |  474668485.79025
 IRAQ                      |   1994 | 476345006.063735
 IRAQ                      |   1993 | 479683951.789111
 IRAQ                      |   1992 | 478024201.900208
 JAPAN                     |   1998 | 272163305.951486
 JAPAN                     |   1997 | 470653315.754017
 JAPAN                     |   1996 | 470778403.227688
 JAPAN                     |   1995 |  472011259.68712
 JAPAN                     |   1994 | 469097167.333684
 JAPAN                     |   1993 | 471678587.744448
 JAPAN                     |   1992 | 473733957.834849
 JORDAN                    |   1998 | 271675804.429273
 JORDAN                    |   1997 | 459956968.195042
 JORDAN                    |   1996 | 461074834.876694
 JORDAN                    |   1995 | 459617665.230823
 JORDAN                    |   1994 | 458678760.966054
 JORDAN                    |   1993 | 464415951.215808
 JORDAN                    |   1992 | 461320972.469546
 KENYA                     |   1998 | 272766068.732612
 KENYA                     |   1997 | 466387713.845625
 KENYA                     |   1996 | 474200888.366621
 KENYA                     |   1995 | 472022497.193297
 KENYA                     |   1994 |  463190655.97962
 KENYA                     |   1993 | 467648740.630704
 KENYA                     |   1992 | 482484481.216293
 MOROCCO                   |   1998 | 283178656.746445
 MOROCCO                   |   1997 |  473828258.67859
 MOROCCO                   |   1996 |  471481461.46323
 MOROCCO                   |   1995 | 471845180.478076
 MOROCCO                   |   1994 |  483886532.48411
 MOROCCO                   |   1993 | 483509654.795483
 MOROCCO                   |   1992 | 473473000.152853
 MOZAMBIQUE                |   1998 | 269907136.162907
 MOZAMBIQUE                |   1997 | 453030302.530091
 MOZAMBIQUE                |   1996 | 453855542.323844
 MOZAMBIQUE                |   1995 | 456485615.755204
 MOZAMBIQUE                |   1994 | 461366681.378316
 MOZAMBIQUE                |   1993 | 455346536.936104
 MOZAMBIQUE                |   1992 | 458661498.362251
 PERU                      |   1998 | 273301977.077144
 PERU                      |   1997 | 459093211.020563
 PERU                      |   1996 | 475700336.968405
 PERU                      |   1995 | 463058515.614076
 PERU                      |   1994 |  460132612.19974
 PERU                      |   1993 | 467826054.270028
 PERU                      |   1992 | 469149949.318505
 ROMANIA                   |   1998 |   273632984.7858
 ROMANIA                   |   1997 | 465964302.757662
 ROMANIA                   |   1996 |  476483290.01162
 ROMANIA                   |   1995 | 470219960.152507
 ROMANIA                   |   1994 | 473808165.580334
 ROMANIA                   |   1993 | 473154880.967332
 ROMANIA                   |   1992 | 478012996.068589
 RUSSIA                    |   1998 | 273215907.115992
 RUSSIA                    |   1997 |  472057744.29388
 RUSSIA                    |   1996 | 463349525.273868
 RUSSIA                    |   1995 |  464802063.70848
 RUSSIA                    |   1994 | 474749465.640254
 RUSSIA                    |   1993 | 470241309.944159
 RUSSIA                    |   1992 | 472431076.231425
 SAUDI ARABIA              |   1998 | 274808492.807507
 SAUDI ARABIA              |   1997 | 462802451.312501
 SAUDI ARABIA              |   1996 | 474196738.493005
 SAUDI ARABIA              |   1995 | 458365658.597382
 SAUDI ARABIA              |   1994 |  462289037.90208
 SAUDI ARABIA              |   1993 | 461496676.749897
 SAUDI ARABIA              |   1992 | 470322172.088696
 UNITED KINGDOM            |   1998 | 272703256.183274
 UNITED KINGDOM            |   1997 |  464936673.98588
 UNITED KINGDOM            |   1996 | 476994633.910507
 UNITED KINGDOM            |   1995 | 471899807.283319
 UNITED KINGDOM            |   1994 |  466084759.66185
 UNITED KINGDOM            |   1993 | 472497505.466441
 UNITED KINGDOM            |   1992 | 464908888.747856
 UNITED STATES             |   1998 | 268999938.831158
 UNITED STATES             |   1997 | 473787554.793767
 UNITED STATES             |   1996 | 478758777.070557
 UNITED STATES             |   1995 | 478106365.585163
 UNITED STATES             |   1994 | 474257228.321495
 UNITED STATES             |   1993 | 467628541.381965
 UNITED STATES             |   1992 | 469997504.468256
 VIETNAM                   |   1998 | 275251192.418049
 VIETNAM                   |   1997 |  466630922.93748
 VIETNAM                   |   1996 | 469218534.017506
 VIETNAM                   |   1995 | 466115368.638727
 VIETNAM                   |   1994 | 468583772.936682
 VIETNAM                   |   1993 | 466914045.975822
 VIETNAM                   |   1992 | 460332528.399639
(175 rows)

COMMIT;
COMMIT
