BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%salmon%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 271064289.362076
 ALGERIA                   |   1997 | 457846853.944782
 ALGERIA                   |   1996 | 464126121.411062
 ALGERIA                   |   1995 | 461171151.362822
 ALGERIA                   |   1994 | 458745468.484384
 ALGERIA                   |   1993 | 457171582.143406
 ALGERIA                   |   1992 | 456134083.793837
 ARGENTINA                 |   1998 | 270384355.990225
 ARGENTINA                 |   1997 | 454469004.912514
 ARGENTINA                 |   1996 | 462604906.301329
 ARGENTINA                 |   1995 | 461844650.458892
 ARGENTINA                 |   1994 | 467072128.216753
 ARGENTINA                 |   1993 | 455610213.326141
 ARGENTINA                 |   1992 | 462886537.923445
 BRAZIL                    |   1998 | 268008737.223393
 BRAZIL                    |   1997 | 457613681.601882
 BRAZIL                    |   1996 |  457216786.88343
 BRAZIL                    |   1995 | 472557579.222666
 BRAZIL                    |   1994 |  459361336.32817
 BRAZIL                    |   1993 | 457820781.674457
 BRAZIL                    |   1992 | 464474923.595243
 CANADA                    |   1998 | 280197128.468786
 CANADA                    |   1997 | 470550749.207852
 CANADA                    |   1996 | 476256857.138104
 CANADA                    |   1995 | 473525287.160528
 CANADA                    |   1994 | 474059898.591344
 CANADA                    |   1993 | 478623661.514498
 CANADA                    |   1992 | 474105511.745921
 CHINA                     |   1998 | 274094942.540981
 CHINA                     |   1997 | 464970423.399317
 CHINA                     |   1996 | 466776464.684272
 CHINA                     |   1995 | 460942133.322607
 CHINA                     |   1994 | 473049757.691477
 CHINA                     |   1993 | 467054367.043323
 CHINA                     |   1992 | 464349446.554867
 EGYPT                     |   1998 | 281311333.295775
 EGYPT                     |   1997 | 473749511.932026
 EGYPT                     |   1996 | 473720708.093994
 EGYPT                     |   1995 | 469470995.459177
 EGYPT                     |   1994 | 468708131.345364
 EGYPT                     |   1993 | 476304074.295658
 EGYPT                     |   1992 | 469077467.688531
 ETHIOPIA                  |   1998 | 262451793.548139
 ETHIOPIA                  |   1997 |  446029736.79888
 ETHIOPIA                  |   1996 | 448227776.747474
 ETHIOPIA                  |   1995 |  446206983.75172
 ETHIOPIA                  |   1994 | 443914163.899792
 ETHIOPIA                  |   1993 | 447272263.653273
 ETHIOPIA                  |   1992 | 448259549.970757
 FRANCE                    |   1998 |  267795663.86471
 FRANCE                    |   1997 | 460141785.730262
 FRANCE                    |   1996 | 462597835.220735
 FRANCE                    |   1995 | 455412391.121279
 FRANCE                    |   1994 |  461965436.86942
 FRANCE                    |   1993 | 462038944.829089
 FRANCE                    |   1992 |  459688163.90229
 GERMANY                   |   1998 | 273424498.225371
 GERMANY                   |   1997 |  477209159.16082
 GERMANY                   |   1996 | 480685294.680636
 GERMANY                   |   1995 | 472501958.192252
 GERMANY                   |   1994 | 480000108.829115
 GERMANY                   |   1993 | 476684926.920368
 GERMANY                   |   1992 | 480361020.761225
 INDIA                     |   1998 | 267698637.647997
 INDIA                     |   1997 | 474083792.028778
 INDIA                     |   1996 | 471795892.598496
 INDIA                     |   1995 | 471585629.795094
 INDIA                     |   1994 | 464713784.351062
 INDIA                     |   1993 | 473697752.545977
 INDIA                     |   1992 | 478041694.479963
 INDONESIA                 |   1998 | 269886741.255584
 INDONESIA                 |   1997 | 464252267.508014
 INDONESIA                 |   1996 | 462098716.731556
 INDONESIA                 |   1995 | 456712918.345089
 INDONESIA                 |   1994 | 456224183.231878
 INDONESIA                 |   1993 | 463791915.132244
 INDONESIA                 |   1992 | 464017581.399363
 IRAN                      |   1998 | 270378195.260355
 IRAN                      |   1997 |  468384841.59081
 IRAN                      |   1996 | 457630073.334557
 IRAN                      |   1995 | 462863062.865949
 IRAN                      |   1994 | 458918380.481513
 IRAN                      |   1993 |  465200894.60208
 IRAN                      |   1992 | 464562571.419686
 IRAQ                      |   1998 |  278729207.82342
 IRAQ                      |   1997 | 468058417.720599
 IRAQ                      |   1996 | 480786861.456068
 IRAQ                      |   1995 | 475851424.512148
 IRAQ                      |   1994 | 479112023.138164
 IRAQ                      |   1993 | 478065646.440304
 IRAQ                      |   1992 | 466124538.112972
 JAPAN                     |   1998 | 265876121.589841
 JAPAN                     |   1997 | 467032680.805287
 JAPAN                     |   1996 | 470981558.313614
 JAPAN                     |   1995 | 465861513.732855
 JAPAN                     |   1994 | 455981713.273254
 JAPAN                     |   1993 | 464691062.553088
 JAPAN                     |   1992 | 461488182.951221
 JORDAN                    |   1998 | 268155223.233138
 JORDAN                    |   1997 | 454659859.576213
 JORDAN                    |   1996 | 454781727.192556
 JORDAN                    |   1995 | 459455132.718741
 JORDAN                    |   1994 | 455833644.916565
 JORDAN                    |   1993 | 452533789.275305
 JORDAN                    |   1992 | 457554802.875036
 KENYA                     |   1998 | 269600140.938675
 KENYA                     |   1997 | 472421571.631473
 KENYA                     |   1996 | 462318786.590006
 KENYA                     |   1995 | 473135762.206891
 KENYA                     |   1994 | 469910960.768467
 KENYA                     |   1993 |   467144776.0361
 KENYA                     |   1992 | 465632806.437936
 MOROCCO                   |   1998 |  270563862.00943
 MOROCCO                   |   1997 | 463218735.768926
 MOROCCO                   |   1996 | 467011018.534774
 MOROCCO                   |   1995 | 466029278.946069
 MOROCCO                   |   1994 | 470384093.316221
 MOROCCO                   |   1993 | 463931370.056484
 MOROCCO                   |   1992 | 464366331.504764
 MOZAMBIQUE                |   1998 | 274463282.720464
 MOZAMBIQUE                |   1997 | 464043746.068708
 MOZAMBIQUE                |   1996 | 465446445.088513
 MOZAMBIQUE                |   1995 | 457340860.372118
 MOZAMBIQUE                |   1994 | 456926369.535873
 MOZAMBIQUE                |   1993 | 463788692.671282
 MOZAMBIQUE                |   1992 | 459504633.955173
 PERU                      |   1998 | 267437638.024358
 PERU                      |   1997 | 463605889.754763
 PERU                      |   1996 |  458698158.46152
 PERU                      |   1995 |  460154933.43018
 PERU                      |   1994 | 454516137.639382
 PERU                      |   1993 | 459615966.946193
 PERU                      |   1992 | 457041144.929275
 ROMANIA                   |   1998 | 273874470.838111
 ROMANIA                   |   1997 | 463045703.681904
 ROMANIA                   |   1996 | 472036601.533419
 ROMANIA                   |   1995 | 463676800.329901
 ROMANIA                   |   1994 | 462020530.634174
 ROMANIA                   |   1993 | 462525172.764672
 ROMANIA                   |   1992 | 459113167.070769
 RUSSIA                    |   1998 | 279718528.556354
 RUSSIA                    |   1997 | 467318025.505425
 RUSSIA                    |   1996 | 473266709.498803
 RUSSIA                    |   1995 | 470358377.684616
 RUSSIA                    |   1994 | 472095678.683125
 RUSSIA                    |   1993 |  470649415.99967
 RUSSIA                    |   1992 | 475749943.197784
 SAUDI ARABIA              |   1998 | 275146087.201126
 SAUDI ARABIA              |   1997 | 457904198.379502
 SAUDI ARABIA              |   1996 | 459329857.902245
 SAUDI ARABIA              |   1995 | 454832046.810525
 SAUDI ARABIA              |   1994 | 459138505.796369
 SAUDI ARABIA              |   1993 |  464326038.36849
 SAUDI ARABIA              |   1992 | 466471465.055055
 UNITED KINGDOM            |   1998 | 262696537.109048
 UNITED KINGDOM            |   1997 | 456219659.688154
 UNITED KINGDOM            |   1996 | 458697263.996813
 UNITED KINGDOM            |   1995 | 459317066.238285
 UNITED KINGDOM            |   1994 | 446955011.566583
 UNITED KINGDOM            |   1993 | 457520762.265876
 UNITED KINGDOM            |   1992 | 452664968.636871
 UNITED STATES             |   1998 | 279741839.271265
 UNITED STATES             |   1997 | 471992943.295847
 UNITED STATES             |   1996 |  471355964.15486
 UNITED STATES             |   1995 | 467362141.143318
 UNITED STATES             |   1994 | 472903788.978243
 UNITED STATES             |   1993 | 474465502.665512
 UNITED STATES             |   1992 | 464819178.125675
 VIETNAM                   |   1998 | 266252932.383584
 VIETNAM                   |   1997 | 463376960.009662
 VIETNAM                   |   1996 | 464779337.363727
 VIETNAM                   |   1995 | 465094541.072543
 VIETNAM                   |   1994 | 470378833.463735
 VIETNAM                   |   1993 | 469457330.698431
 VIETNAM                   |   1992 | 471981997.881409
(175 rows)

COMMIT;
COMMIT
