BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%dodger%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 263997673.060803
 ALGERIA                   |   1997 | 459862733.713142
 ALGERIA                   |   1996 |  464058072.50798
 ALGERIA                   |   1995 | 458396096.251412
 ALGERIA                   |   1994 | 454031969.228862
 ALGERIA                   |   1993 | 461429052.463416
 ALGERIA                   |   1992 | 466182573.458441
 ARGENTINA                 |   1998 | 276654500.774568
 ARGENTINA                 |   1997 | 470942278.524357
 ARGENTINA                 |   1996 | 479433519.672287
 ARGENTINA                 |   1995 | 468871166.653769
 ARGENTINA                 |   1994 | 474859608.104086
 ARGENTINA                 |   1993 | 477724019.306326
 ARGENTINA                 |   1992 | 474610079.635179
 BRAZIL                    |   1998 | 279247929.465584
 BRAZIL                    |   1997 | 472132576.344535
 BRAZIL                    |   1996 | 473758083.102819
 BRAZIL                    |   1995 | 466106428.511506
 BRAZIL                    |   1994 |  467494763.45895
 BRAZIL                    |   1993 | 468134664.652007
 BRAZIL                    |   1992 | 468142179.427415
 CANADA                    |   1998 | 282507130.999293
 CANADA                    |   1997 |  472855931.58274
 CANADA                    |   1996 | 477596476.243725
 CANADA                    |   1995 | 471948829.318341
 CANADA                    |   1994 | 473232341.664444
 CANADA                    |   1993 | 477254984.350493
 CANADA                    |   1992 | 479445942.096496
 CHINA                     |   1998 | 273109048.236748
 CHINA                     |   1997 | 461542318.172935
 CHINA                     |   1996 | 464180713.966517
 CHINA                     |   1995 | 468350060.274606
 CHINA                     |   1994 | 465770396.951053
 CHINA                     |   1993 | 464966772.599143
 CHINA                     |   1992 | 459904509.267348
 EGYPT                     |   1998 |  271445773.41412
 EGYPT                     |   1997 | 458008426.650847
 EGYPT                     |   1996 | 472232334.196274
 EGYPT                     |   1995 | 464668762.496379
 EGYPT                     |   1994 | 470183198.314944
 EGYPT                     |   1993 | 457009548.620471
 EGYPT                     |   1992 | 464977223.907621
 ETHIOPIA                  |   1998 | 273330108.438265
 ETHIOPIA                  |   1997 |  464571548.58086
 ETHIOPIA                  |   1996 | 464340923.193966
 ETHIOPIA                  |   1995 | 460476543.381883
 ETHIOPIA                  |   1994 | 470512974.672056
 ETHIOPIA                  |   1993 | 460665974.796009
 ETHIOPIA                  |   1992 | 466408575.081896
 FRANCE                    |   1998 | 266922765.254143
 FRANCE                    |   1997 | 459000267.487658
 FRANCE                    |   1996 | 457789074.226208
 FRANCE                    |   1995 | 462760981.719546
 FRANCE                    |   1994 |  459040480.08674
 FRANCE                    |   1993 |  460829911.15925
 FRANCE                    |   1992 | 463292410.466998
 GERMANY                   |   1998 | 276191445.467415
 GERMANY                   |   1997 | 472024701.232838
 GERMANY                   |   1996 | 474428286.580702
 GERMANY                   |   1995 | 476619848.893143
 GERMANY                   |   1994 | 476901336.217062
 GERMANY                   |   1993 |  470778870.78716
 GERMANY                   |   1992 |  473964401.29349
 INDIA                     |   1998 | 278107373.191492
 INDIA                     |   1997 | 459625311.869913
 INDIA                     |   1996 | 470030810.058691
 INDIA                     |   1995 | 471550537.430766
 INDIA                     |   1994 | 469105386.589357
 INDIA                     |   1993 | 479106360.850319
 INDIA                     |   1992 | 466972061.052096
 INDONESIA                 |   1998 | 267292190.437758
 INDONESIA                 |   1997 | 459068555.284549
 INDONESIA                 |   1996 | 458729706.042493
 INDONESIA                 |   1995 | 454760675.838507
 INDONESIA                 |   1994 | 452213550.706474
 INDONESIA                 |   1993 | 458747908.190674
 INDONESIA                 |   1992 | 459755080.357935
 IRAN                      |   1998 | 266709487.858267
 IRAN                      |   1997 | 462424890.674983
 IRAN                      |   1996 | 462884846.783512
 IRAN                      |   1995 | 466674182.668773
 IRAN                      |   1994 | 466900124.645365
 IRAN                      |   1993 | 462656303.691831
 IRAN                      |   1992 | 468942060.315483
 IRAQ                      |   1998 | 276736728.490699
 IRAQ                      |   1997 | 474745466.281372
 IRAQ                      |   1996 | 474994166.491511
 IRAQ                      |   1995 | 478066553.808875
 IRAQ                      |   1994 | 477367747.068406
 IRAQ                      |   1993 | 479617491.706607
 IRAQ                      |   1992 | 478721088.793815
 JAPAN                     |   1998 | 275620439.230529
 JAPAN                     |   1997 | 473136001.819053
 JAPAN                     |   1996 | 481794571.377386
 JAPAN                     |   1995 | 460039135.120039
 JAPAN                     |   1994 | 468283216.478513
 JAPAN                     |   1993 | 475719805.480708
 JAPAN                     |   1992 | 469740514.087332
 JORDAN                    |   1998 | 273178823.077162
 JORDAN                    |   1997 | 459802564.148126
 JORDAN                    |   1996 | 457406646.816347
 JORDAN                    |   1995 | 461516570.805989
 JORDAN                    |   1994 | 457693491.823867
 JORDAN                    |   1993 | 456529449.340918
 JORDAN                    |   1992 | 459700297.457138
 KENYA                     |   1998 |  273363592.12658
 KENYA                     |   1997 | 477259322.979015
 KENYA                     |   1996 | 472524362.154559
 KENYA                     |   1995 | 471214147.642312
 KENYA                     |   1994 | 473264515.193511
 KENYA                     |   1993 |  473650919.61645
 KENYA                     |   1992 | 481035656.750684
 MOROCCO                   |   1998 | 277001124.593046
 MOROCCO                   |   1997 | 469451209.229997
 MOROCCO                   |   1996 | 474806946.121423
 MOROCCO                   |   1995 | 472141105.144855
 MOROCCO                   |   1994 | 476809106.237812
 MOROCCO                   |   1993 | 470923425.122912
 MOROCCO                   |   1992 | 473671280.461617
 MOZAMBIQUE                |   1998 | 269507919.326117
 MOZAMBIQUE                |   1997 | 459421741.493242
 MOZAMBIQUE                |   1996 | 468157658.620439
 MOZAMBIQUE                |   1995 | 454988201.245893
 MOZAMBIQUE                |   1994 | 451524650.436184
 MOZAMBIQUE                |   1993 |  456284378.65971
 MOZAMBIQUE                |   1992 | 457484610.607248
 PERU                      |   1998 | 271685880.030192
 PERU                      |   1997 | 468380198.132724
 PERU                      |   1996 | 468979084.362992
 PERU                      |   1995 | 464479687.526404
 PERU                      |   1994 |  460126089.60522
 PERU                      |   1993 |  472792261.26771
 PERU                      |   1992 | 459832824.975793
 ROMANIA                   |   1998 | 268608932.985219
 ROMANIA                   |   1997 | 463883007.878491
 ROMANIA                   |   1996 | 470466174.112002
 ROMANIA                   |   1995 |  458832641.57515
 ROMANIA                   |   1994 | 462083855.272753
 ROMANIA                   |   1993 | 465579593.714856
 ROMANIA                   |   1992 | 462970662.181262
 RUSSIA                    |   1998 | 278448295.010663
 RUSSIA                    |   1997 | 477657905.012228
 RUSSIA                    |   1996 | 476229812.891026
 RUSSIA                    |   1995 | 471734628.991641
 RUSSIA                    |   1994 | 467907535.358697
 RUSSIA                    |   1993 | 472096064.189778
 RUSSIA                    |   1992 | 473810572.448018
 SAUDI ARABIA              |   1998 | 278086766.774912
 SAUDI ARABIA              |   1997 | 465059510.300276
 SAUDI ARABIA              |   1996 | 470144390.659503
 SAUDI ARABIA              |   1995 | 466032441.316405
 SAUDI ARABIA              |   1994 |   462512907.2677
 SAUDI ARABIA              |   1993 | 469036516.832913
 SAUDI ARABIA              |   1992 | 467706750.819868
 UNITED KINGDOM            |   1998 | 267044187.191281
 UNITED KINGDOM            |   1997 | 458016926.722156
 UNITED KINGDOM            |   1996 |  453738237.46396
 UNITED KINGDOM            |   1995 | 460994937.833423
 UNITED KINGDOM            |   1994 | 457347462.502844
 UNITED KINGDOM            |   1993 | 460811496.379924
 UNITED KINGDOM            |   1992 | 461440361.149843
 UNITED STATES             |   1998 | 277455262.891212
 UNITED STATES             |   1997 | 475053880.835994
 UNITED STATES             |   1996 | 484484123.743047
 UNITED STATES             |   1995 | 478225838.096905
 UNITED STATES             |   1994 | 485493330.351697
 UNITED STATES             |   1993 | 475642439.932726
 UNITED STATES             |   1992 | 474326016.745055
 VIETNAM                   |   1998 | 275573571.001226
 VIETNAM                   |   1997 |  457668738.59989
 VIETNAM                   |   1996 | 471999985.147974
 VIETNAM                   |   1995 | 471203117.939011
 VIETNAM                   |   1994 | 463713798.233643
 VIETNAM                   |   1993 | 472696246.649491
 VIETNAM                   |   1992 | 467128948.966925
(175 rows)

COMMIT;
COMMIT
