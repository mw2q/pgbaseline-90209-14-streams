BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%burnished%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 |  267408929.65673
 ALGERIA                   |   1997 | 449429147.791649
 ALGERIA                   |   1996 | 458056058.033468
 ALGERIA                   |   1995 | 454794274.015822
 ALGERIA                   |   1994 | 456609785.635427
 ALGERIA                   |   1993 | 450186134.983676
 ALGERIA                   |   1992 | 451719319.105001
 ARGENTINA                 |   1998 | 273115142.545156
 ARGENTINA                 |   1997 | 471049161.920427
 ARGENTINA                 |   1996 |  468695443.73842
 ARGENTINA                 |   1995 | 469367557.606551
 ARGENTINA                 |   1994 | 469035639.263613
 ARGENTINA                 |   1993 | 470290774.583435
 ARGENTINA                 |   1992 | 464772957.177802
 BRAZIL                    |   1998 | 276795442.327929
 BRAZIL                    |   1997 | 459523496.540067
 BRAZIL                    |   1996 | 464040910.145696
 BRAZIL                    |   1995 | 460615130.545786
 BRAZIL                    |   1994 | 460491480.295956
 BRAZIL                    |   1993 | 460686380.382663
 BRAZIL                    |   1992 | 462368723.726998
 CANADA                    |   1998 | 280488107.532257
 CANADA                    |   1997 |  471910852.89993
 CANADA                    |   1996 | 477971010.892358
 CANADA                    |   1995 | 476408564.662054
 CANADA                    |   1994 | 480119324.106587
 CANADA                    |   1993 | 482624702.115794
 CANADA                    |   1992 | 480322321.298238
 CHINA                     |   1998 | 271090486.381433
 CHINA                     |   1997 | 463964987.213659
 CHINA                     |   1996 | 462770039.094498
 CHINA                     |   1995 | 456498343.209787
 CHINA                     |   1994 | 462490297.705695
 CHINA                     |   1993 | 461450500.693367
 CHINA                     |   1992 | 464856612.503997
 EGYPT                     |   1998 | 269161289.597576
 EGYPT                     |   1997 | 457127300.830295
 EGYPT                     |   1996 | 463933512.435141
 EGYPT                     |   1995 | 462398115.985957
 EGYPT                     |   1994 | 461471074.618283
 EGYPT                     |   1993 | 468713598.667593
 EGYPT                     |   1992 | 460719788.251993
 ETHIOPIA                  |   1998 | 272180842.067928
 ETHIOPIA                  |   1997 | 450461429.854509
 ETHIOPIA                  |   1996 | 457791291.946475
 ETHIOPIA                  |   1995 | 463738138.390444
 ETHIOPIA                  |   1994 | 457392271.383002
 ETHIOPIA                  |   1993 | 457221665.318637
 ETHIOPIA                  |   1992 | 456869329.675943
 FRANCE                    |   1998 | 273653420.119783
 FRANCE                    |   1997 |  459226879.05835
 FRANCE                    |   1996 | 454408344.387716
 FRANCE                    |   1995 | 458356701.281464
 FRANCE                    |   1994 | 449361922.640779
 FRANCE                    |   1993 | 458129516.861633
 FRANCE                    |   1992 | 458483996.062597
 GERMANY                   |   1998 | 277348291.877545
 GERMANY                   |   1997 | 477859289.336152
 GERMANY                   |   1996 | 473631863.617788
 GERMANY                   |   1995 |  485196558.53198
 GERMANY                   |   1994 | 473104585.855098
 GERMANY                   |   1993 | 474274541.597894
 GERMANY                   |   1992 | 487461635.048759
 INDIA                     |   1998 | 276464570.808352
 INDIA                     |   1997 | 472265182.270642
 INDIA                     |   1996 |  472948743.94549
 INDIA                     |   1995 | 466042393.674944
 INDIA                     |   1994 |  474463783.51224
 INDIA                     |   1993 | 471961649.320547
 INDIA                     |   1992 | 471881663.046268
 INDONESIA                 |   1998 | 272819429.435497
 INDONESIA                 |   1997 | 460062461.790919
 INDONESIA                 |   1996 | 471993972.695768
 INDONESIA                 |   1995 | 461185045.028878
 INDONESIA                 |   1994 | 464553412.644929
 INDONESIA                 |   1993 | 464183548.177959
 INDONESIA                 |   1992 | 459321952.985609
 IRAN                      |   1998 | 273843668.600555
 IRAN                      |   1997 | 460975688.653125
 IRAN                      |   1996 | 465753220.599008
 IRAN                      |   1995 | 469123144.180476
 IRAN                      |   1994 | 461697685.713468
 IRAN                      |   1993 | 463072378.632465
 IRAN                      |   1992 | 461366698.229679
 IRAQ                      |   1998 | 278390628.580776
 IRAQ                      |   1997 | 471747451.372911
 IRAQ                      |   1996 |  478791221.96193
 IRAQ                      |   1995 | 476451545.644771
 IRAQ                      |   1994 | 477952089.747805
 IRAQ                      |   1993 | 474121293.479393
 IRAQ                      |   1992 |  473446242.12342
 JAPAN                     |   1998 | 266528953.856603
 JAPAN                     |   1997 | 462522523.178543
 JAPAN                     |   1996 | 467147152.142628
 JAPAN                     |   1995 |  459077635.47158
 JAPAN                     |   1994 | 472473287.993335
 JAPAN                     |   1993 | 468845646.685594
 JAPAN                     |   1992 | 468266630.696712
 JORDAN                    |   1998 | 272320727.300021
 JORDAN                    |   1997 | 462643677.984287
 JORDAN                    |   1996 | 462966146.739535
 JORDAN                    |   1995 | 459031645.893343
 JORDAN                    |   1994 | 459595337.823882
 JORDAN                    |   1993 | 464255597.537103
 JORDAN                    |   1992 | 461331270.766162
 KENYA                     |   1998 | 271313271.364722
 KENYA                     |   1997 | 465210137.446103
 KENYA                     |   1996 | 462898348.873413
 KENYA                     |   1995 | 460020536.798082
 KENYA                     |   1994 | 467623277.540138
 KENYA                     |   1993 | 465169725.189882
 KENYA                     |   1992 | 472030886.533925
 MOROCCO                   |   1998 |  275570951.99463
 MOROCCO                   |   1997 | 468897234.372049
 MOROCCO                   |   1996 | 463331013.935075
 MOROCCO                   |   1995 | 465383097.709134
 MOROCCO                   |   1994 | 468056520.524522
 MOROCCO                   |   1993 | 472782528.659328
 MOROCCO                   |   1992 | 466587365.527067
 MOZAMBIQUE                |   1998 | 273648331.075285
 MOZAMBIQUE                |   1997 |  475606601.71257
 MOZAMBIQUE                |   1996 | 473266888.237642
 MOZAMBIQUE                |   1995 | 467732376.194141
 MOZAMBIQUE                |   1994 | 472501151.181383
 MOZAMBIQUE                |   1993 |  465954517.98492
 MOZAMBIQUE                |   1992 | 470222436.213916
 PERU                      |   1998 |   271912824.9935
 PERU                      |   1997 | 475728015.459761
 PERU                      |   1996 |  479089766.22766
 PERU                      |   1995 | 470879629.364991
 PERU                      |   1994 | 467257785.305927
 PERU                      |   1993 | 469437259.989228
 PERU                      |   1992 | 475646379.841629
 ROMANIA                   |   1998 | 273188153.221593
 ROMANIA                   |   1997 | 462333066.696563
 ROMANIA                   |   1996 | 478304165.890301
 ROMANIA                   |   1995 | 464581496.275288
 ROMANIA                   |   1994 | 473302113.225303
 ROMANIA                   |   1993 | 471833727.721908
 ROMANIA                   |   1992 | 473820419.151055
 RUSSIA                    |   1998 | 281869088.688503
 RUSSIA                    |   1997 | 482554817.662487
 RUSSIA                    |   1996 | 479128682.700925
 RUSSIA                    |   1995 |  472306486.03297
 RUSSIA                    |   1994 | 480404777.053191
 RUSSIA                    |   1993 | 470499081.306004
 RUSSIA                    |   1992 | 478442863.077713
 SAUDI ARABIA              |   1998 | 276480046.087286
 SAUDI ARABIA              |   1997 | 469000060.646119
 SAUDI ARABIA              |   1996 | 478312608.839026
 SAUDI ARABIA              |   1995 | 468132166.787973
 SAUDI ARABIA              |   1994 | 471857150.707295
 SAUDI ARABIA              |   1993 | 468711779.921293
 SAUDI ARABIA              |   1992 | 474274708.448724
 UNITED KINGDOM            |   1998 |  271217592.08448
 UNITED KINGDOM            |   1997 | 471406773.926101
 UNITED KINGDOM            |   1996 | 465108752.050791
 UNITED KINGDOM            |   1995 | 462494126.592446
 UNITED KINGDOM            |   1994 | 461213026.019862
 UNITED KINGDOM            |   1993 | 460639627.846323
 UNITED KINGDOM            |   1992 | 460760872.500654
 UNITED STATES             |   1998 | 271684479.580608
 UNITED STATES             |   1997 | 460498802.811921
 UNITED STATES             |   1996 | 475978195.744963
 UNITED STATES             |   1995 | 468773817.811855
 UNITED STATES             |   1994 | 471075226.249803
 UNITED STATES             |   1993 | 465622634.241782
 UNITED STATES             |   1992 | 471918315.042556
 VIETNAM                   |   1998 | 277391467.878546
 VIETNAM                   |   1997 | 472743805.743711
 VIETNAM                   |   1996 | 478483678.594397
 VIETNAM                   |   1995 | 470194422.400637
 VIETNAM                   |   1994 | 471938831.523462
 VIETNAM                   |   1993 | 478774764.352174
 VIETNAM                   |   1992 | 475089775.897601
(175 rows)

COMMIT;
COMMIT
